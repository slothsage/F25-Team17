{% extends "base.html" %}
{% load static %}
{% block title %}Edit Profile Picture{% endblock title %}

{% block content %}
<div class="container-main">
    <div class="card">
        <div class="card-header">
            <h1 class="card-title">Edit Profile Picture</h1>
        </div>
        <div class="card-body">
            <div class="stack gap-lg">
                <!-- Current Profile Picture -->
                <div class="profile-picture-preview">
                    <h3>Current Profile Picture</h3>
                    {% if profile.image %}
                        <img src="{{ profile.image.url }}"
                             alt="Current profile picture"
                             style="width:150px;height:150px;object-fit:cover;border-radius:75px;border:3px solid #ddd;margin-bottom:1rem;">
                    {% else %}
                        <div style="width:150px;height:150px;background-color:#f0f0f0;border-radius:75px;border:3px solid #ddd;display:flex;align-items:center;justify-content:center;margin-bottom:1rem;">
                            <span style="color:#999;font-size:14px;">No photo</span>
                        </div>
                    {% endif %}
                </div>

                <!-- Upload Form -->
                <form method="post" enctype="multipart/form-data" class="stack gap-md">
                    {% csrf_token %}
                    
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {{ form.non_field_errors }}
                        </div>
                    {% endif %}

                    <div class="form-group">
                        <label for="{{ form.image.id_for_label }}" class="form-label">
                            Choose New Profile Picture
                        </label>
                        {{ form.image }}
                        {% if form.image.errors %}
                            <div class="form-error">
                                {{ form.image.errors }}
                            </div>
                        {% endif %}
                        <small class="form-help">
                            Supported formats: JPEG, PNG, GIF, WebP. Maximum size: 5MB.
                        </small>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            Upload Picture
                        </button>
                        <a href="{% url 'accounts:profile' %}" class="btn btn-secondary">
                            Cancel
                        </a>
                        {% if profile.image %}
                            <button type="submit" name="remove_picture" value="1" class="btn btn-danger" 
                                    onclick="return confirm('Are you sure you want to remove your profile picture?');">
                                Remove Picture
                            </button>
                        {% endif %}
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
.profile-picture-preview {
    text-align: center;
    padding: 1rem;
    background: #fafafa;
    border-radius: 8px;
}

.form-group {
    margin-bottom: 1rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.form-error {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.25rem;
}

.form-help {
    color: #666;
    font-size: 0.875rem;
    margin-top: 0.25rem;
    display: block;
}

.form-actions {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.alert {
    padding: 0.75rem 1rem;
    border-radius: 4px;
    margin-bottom: 1rem;
}

.alert-danger {
    background-color: #f8d7da;
    border: 1px solid #f5c6cb;
    color: #721c24;
}
</style>
{% endblock content %}