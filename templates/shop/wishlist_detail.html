{% extends "base.html" %}
{% block content %}
<h1>{{ wishlist.name }}</h1>
<a href="{% url 'wishlist_list' %}">&larr; Back to all wishlists</a>

<!-- Add item form (snapshot now; eBay fields can be wired later) -->
<h3>Add item</h3>
<form method="post">
    {% csrf_token %}
    <input type="hidden" name="action" value="add_item">
    <input type="text" name="name_snapshot" placeholder="Item name" required>
    <input type="number" name="points_each" placeholder="Points each" min="0" step="1">
    <input type="number" name="quantity" value="1" min="1" step="1">

    <!-- FUTURE: include hidden or visible fields populated from eBay result cards -->
    <!-- <input type="hidden" name="product_id"> -->
    <!-- <input type="hidden" name="product_url"> -->
    <!-- <input type="hidden" name="thumb_url"> -->

    <button type="submit">Add</button>
</form>

<h3 class="mt-3">Items</h3>
{% if items %}
    <ul>
    {% for it in items %}
    <li>
        {% if it.thumb_url %}<img src="{{ it.thumb_url }}" alt="" style="height:40px;vertical-align:middle;">{% endif %}
        <strong>{{ it.name_snapshot }}</strong>
        ({{ it.quantity }} Ã— {{ it.points_each }} pts = {{ it.line_points }} pts)
        {% if it.product_url %}<a href="{{ it.product_url }}" target="_blank" rel="noopener">View</a>{% endif %}
        <form method="post" action="{% url 'wishlist_item_remove' wishlist.id it.id %}" style="display:inline;">
    {% csrf_token %}
        <button type="submit">Remove</button>
    </form>
    </li>
{% endfor %}
    </ul>
{% else %}
    <p>No items yet.</p>
{% endif %}
{% endblock %}
