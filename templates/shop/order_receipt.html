{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Order Receipt #{{ order.id }}</title>
  <style>
    /* Keep CSS simple for xhtml2pdf compatibility */
    body { font-family: DejaVu Sans, Arial, Helvetica, sans-serif; font-size: 12px; color:#111; }
    .muted { color:#555; }
    h1 { font-size: 20px; margin: 0 0 8px; }
    h2 { font-size: 14px; margin: 18px 0 6px; }
    .row { display: block; margin-bottom: 6px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
    th { background: #f2f2f2; }
    .totals { margin-top: 10px; width: 100%; }
    .totals td { border: none; padding: 4px 0; }
    .right { text-align: right; }
    .small { font-size: 10px; }
  </style>
</head>
<body>
  <h1>Order Receipt</h1>
  <div class="row muted">Order #: <strong>{{ order.id }}</strong></div>
  <div class="row muted">Placed: {{ order.placed_at }}</div>
  <div class="row muted">Status: {{ order.get_status_display }}</div>

  <h2>Driver</h2>
  <div class="row">{{ user.get_full_name|default:user.username }}</div>
  <div class="row small muted">{{ user.email }}</div>

  {% if order.sponsor_name %}
  <h2>Sponsor</h2>
  <div class="row">{{ order.sponsor_name }}</div>
  {% endif %}

  <h2>Items</h2>
  <table>
    <thead>
      <tr>
        <th style="width:55%;">Item</th>
        <th class="right" style="width:15%;">Points Each</th>
        <th class="right" style="width:15%;">Qty</th>
        <th class="right" style="width:15%;">Line Points</th>
      </tr>
    </thead>
    <tbody>
      {% for it in items %}
      <tr>
        <td>{{ it.name_snapshot }}</td>
        <td class="right">{{ it.points_each }}</td>
        <td class="right">{{ it.quantity }}</td>
        <td class="right">{{ it.line_points }}</td>      </tr>
      {% empty %}
      <tr><td colspan="4" class="muted">No items.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <table class="totals">
    <tr>
      <td class="right"><strong>Total Points Spent:</strong> {{ order.points_spent|default:subtotal_points }}</td>
    </tr>
  </table>

  <div class="row small muted" style="margin-top:18px;">
    Generated by Driver Incentive Program â€¢ Order #{{ order.id }}
  </div>
</body>
</html>